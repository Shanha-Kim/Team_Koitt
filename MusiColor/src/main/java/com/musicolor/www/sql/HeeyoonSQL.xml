<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
			PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
			"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
			

<mapper namespace="hSQL">


<!-- 프로필 사진 올리기 SQL -->
<update id="addpic" parameterType="fVO">

UPDATE
	profilepicture
<set>
 p_no = #{pno}, p_oriname =#{oriname} , p_savename=#{savename}, p_dir=#{dir} p_length=#{length}, p_date=#{date} 

WHERE
p_no = #{no}

</set>
</update>

 <!-- 프로필 텍스트 수정 SQL -->

<update id="profileconfig" parameterType="mVO">
<selectKey resultType="int" keyProperty ="m_no" order ="BEFORE">
	  SELECT
   		m_no	
   	FROM
   		member
   	WHERE
   		m_id = #{m_id}
</selectKey>
UPDATE
member
<set>
m_id=#{m_id}, m_about=#{m_about}, m_email=#{m_email}, m_tel=#{m_tel}
WHERE
m_no =#{m_no}
</set>

</update>

<!-- 개인프로필 음악앨범  리스트  SQL-->
<select id ="addalbumpic"  resultType="fVO" parameterType="String" >
<![CDATA[
SELECT
            b_no no, (SELECT a_sname FROM albumpicture WHERE b_ano = a_no) sname
         FROM
            board
         WHERE
            b_mno = (SELECT m_no  FROM member WHERE m_id =#{SID})
            AND rownum <= 9 ]]>

</select> 

 <select id="mNo" resultType="int" parameterType="String">
 	SELECT
 		m_no
 	FROM
 		member
 	WHERE
 		m_id = #{SID}
 </select>


<!-- 프로필 파일 로고 가져오기 -->
<select id="proflogo" resultType="fVO" parameterType="String">
SELECT
	p_sname sname, p_oname oname, p_dir dir
FROM

profilepicture

WHERE

p_no = (SELECT
			m_pno
		FROM
			member
		WHERE
			m_id= #{SID}
		)


</select>

<!-- 자기소개글 보내기  -->
<select id ="introtext" resultType="mVO" parameterType="String">

SELECT
m_about m_about

FROM
member

WHERE
	m_id =#{SID}
</select>

<!-- 게시물 카운트 전담처리함수 -->

<select id ="textcount" resultType="int" parameterType="String">
SELECT

count (*)

FROM 
board

WHERE
 b_mno = (SELECT
  			m_no
  			FROM
  			member
			WHERE
			m_id =#{SID}  		
 	)
 
  
</select>

</mapper>

